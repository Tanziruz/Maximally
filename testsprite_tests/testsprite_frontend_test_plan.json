[
  {
    "id": "TC001",
    "title": "User Registration with Valid Data",
    "description": "Verify that a user can register successfully with valid email and password.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/auth/register with valid name, email, and password."
      },
      {
        "type": "assertion",
        "description": "Response success is true, user object is returned with id and email, and JWT token is issued."
      },
      {
        "type": "assertion",
        "description": "Check password is hashed in the database, not stored in plain text."
      }
    ]
  },
  {
    "id": "TC002",
    "title": "User Registration with Existing Email",
    "description": "Verify that registration fails if the email is already registered.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/auth/register with an email that already exists in the system."
      },
      {
        "type": "assertion",
        "description": "Response success is false and proper error message about duplicate email is returned."
      }
    ]
  },
  {
    "id": "TC003",
    "title": "User Login with Valid Credentials",
    "description": "Verify user can login successfully with correct email and password and receives a valid JWT token.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/auth/login with valid email and password."
      },
      {
        "type": "assertion",
        "description": "Response success is true, user object is returned, and JWT token is issued."
      }
    ]
  },
  {
    "id": "TC004",
    "title": "User Login with Invalid Credentials",
    "description": "Verify login fails with incorrect email or password.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/auth/login with invalid email or password."
      },
      {
        "type": "assertion",
        "description": "Response success is false and error message indicating invalid credentials is returned."
      }
    ]
  },
  {
    "id": "TC005",
    "title": "Access Protected Route with Valid JWT",
    "description": "Verify that accessing a protected endpoint with valid JWT token succeeds.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Login user and obtain a valid JWT token."
      },
      {
        "type": "action",
        "description": "Send GET request to /api/auth/me with Authorization header containing valid JWT token."
      },
      {
        "type": "assertion",
        "description": "Response success is true and correct user object is returned."
      }
    ]
  },
  {
    "id": "TC006",
    "title": "Access Protected Route with Invalid or Missing JWT",
    "description": "Verify that accessing a protected endpoint without or with invalid JWT token fails.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send GET request to /api/auth/me with no Authorization header."
      },
      {
        "type": "assertion",
        "description": "Response is 401 Unauthorized."
      },
      {
        "type": "action",
        "description": "Send GET request to /api/auth/me with invalid or expired JWT token."
      },
      {
        "type": "assertion",
        "description": "Response is 401 Unauthorized."
      }
    ]
  },
  {
    "id": "TC007",
    "title": "Send Message to AI Chat and Receive Workflow Draft",
    "description": "Verify that user can send message to /api/chat and AI returns a conversation response and optionally a workflow draft.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/chat with a valid message."
      },
      {
        "type": "assertion",
        "description": "Response success is true, conversationId is returned, AI response text is returned, and optionally a workflow object draft is present."
      },
      {
        "type": "assertion",
        "description": "Verify conversation history is stored and updated for the user."
      }
    ]
  },
  {
    "id": "TC008",
    "title": "Retrieve All Workflows for Authenticated User",
    "description": "Verify that user can fetch a list of all workflows they own via /api/workflows.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated GET request to /api/workflows."
      },
      {
        "type": "assertion",
        "description": "Response success is true and an array of workflow objects belonging to the user is returned."
      }
    ]
  },
  {
    "id": "TC009",
    "title": "Create New Workflow with Valid Data",
    "description": "Verify that authenticated user can create a new workflow with valid trigger and steps.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated POST request to /api/workflows with valid name, description, trigger (e.g. cron), and steps array."
      },
      {
        "type": "assertion",
        "description": "Response success is true and workflow object is returned with correct data."
      },
      {
        "type": "assertion",
        "description": "Verify workflow is stored in database linked to the user."
      }
    ]
  },
  {
    "id": "TC010",
    "title": "Retrieve Specific Workflow by ID",
    "description": "Verify that user can fetch the details of a specific workflow by ID if it belongs to them.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated GET request to /api/workflows/:id with a valid workflow ID."
      },
      {
        "type": "assertion",
        "description": "Response success is true and the workflow object details are returned."
      },
      {
        "type": "action",
        "description": "Send GET request with invalid or non-existent workflow ID."
      },
      {
        "type": "assertion",
        "description": "Response indicates workflow not found or access forbidden."
      }
    ]
  },
  {
    "id": "TC011",
    "title": "Update Workflow Partially and Fully",
    "description": "Verify that user can update the workflow's name, description, trigger, steps, and enabled flag via PUT /api/workflows/:id.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated PUT request to /api/workflows/:id with partial fields e.g. only enabled flag changed."
      },
      {
        "type": "assertion",
        "description": "Response success is true and workflow object reflects updated data."
      },
      {
        "type": "action",
        "description": "Send PUT request with full update of all fields."
      },
      {
        "type": "assertion",
        "description": "Response success is true and database reflects all updated fields."
      },
      {
        "type": "action",
        "description": "Send PUT request with invalid or malformed data."
      },
      {
        "type": "assertion",
        "description": "Response contains validation errors and update is rejected."
      }
    ]
  },
  {
    "id": "TC012",
    "title": "Delete Workflow Successfully",
    "description": "Verify that authenticated user can delete their workflow with DELETE /api/workflows/:id.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated DELETE request to /api/workflows/:id with valid workflow ID."
      },
      {
        "type": "assertion",
        "description": "Response success is true and workflow is removed from database."
      },
      {
        "type": "action",
        "description": "Send DELETE request with invalid or unauthorized workflow ID."
      },
      {
        "type": "assertion",
        "description": "Response indicates failure or access denied."
      }
    ]
  },
  {
    "id": "TC013",
    "title": "Manual Workflow Execution Trigger",
    "description": "Verify that user can manually trigger execution of a workflow via POST /api/workflows/:id/execute and execution history records are created.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send authenticated POST request to /api/workflows/:id/execute with valid workflow ID."
      },
      {
        "type": "assertion",
        "description": "Response success is true and execution object is returned with status, started_at timestamp."
      },
      {
        "type": "assertion",
        "description": "Execution history is recorded in database for the workflow execution."
      }
    ]
  },
  {
    "id": "TC014",
    "title": "Webhook Trigger Workflow Execution",
    "description": "Verify that sending HTTP requests to the unique webhook URL triggers workflow execution and passes payload correctly.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send HTTP POST request to /api/webhooks/:workflowId with valid payload."
      },
      {
        "type": "assertion",
        "description": "Response success is true and execution object is returned."
      },
      {
        "type": "assertion",
        "description": "Payload from webhook is passed correctly as trigger_data in execution record."
      },
      {
        "type": "action",
        "description": "Send webhook requests with different HTTP methods (GET, POST, PUT, DELETE) as supported."
      },
      {
        "type": "assertion",
        "description": "Workflow triggers accordingly if the method is supported."
      }
    ]
  },
  {
    "id": "TC015",
    "title": "Workflow Execution of Various Action Types",
    "description": "Verify execution supports HTTP request, email sending, data transformation, conditional logic, delay actions, and correctly tracks step results.",
    "category": "integration",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Create workflow with mixed action steps including HTTP request, send email, data transformation, conditional logic, and delay."
      },
      {
        "type": "action",
        "description": "Trigger workflow execution manually."
      },
      {
        "type": "assertion",
        "description": "Each step executes successfully, step results are recorded correctly."
      },
      {
        "type": "assertion",
        "description": "Conditional logic correctly evaluates and executes respective branches."
      },
      {
        "type": "assertion",
        "description": "Delays are honored for delay steps."
      },
      {
        "type": "assertion",
        "description": "HTTP requests and emails are sent as specified (mocking external services)."
      }
    ]
  },
  {
    "id": "TC016",
    "title": "Workflow Execution Retry on Failure",
    "description": "Verify that failed workflow executions are retried according to retry policy and failures are logged.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Create workflow with step designed to fail (e.g., HTTP request to invalid URL)."
      },
      {
        "type": "action",
        "description": "Execute workflow manually."
      },
      {
        "type": "assertion",
        "description": "Execution fails initially but retries happen as configured."
      },
      {
        "type": "assertion",
        "description": "Error messages are logged in execution history."
      }
    ]
  },
  {
    "id": "TC017",
    "title": "Data Validation on Workflow Creation and Updates",
    "description": "Verify that workflow creation and updates reject invalid data such as missing required fields, invalid cron expressions, or bad step definitions.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send POST /api/workflows with missing name or invalid trigger."
      },
      {
        "type": "assertion",
        "description": "Response contains validation error and creation fails."
      },
      {
        "type": "action",
        "description": "Send PUT /api/workflows/:id with invalid steps data or malformed JSON."
      },
      {
        "type": "assertion",
        "description": "Response contains validation error and update fails."
      }
    ]
  },
  {
    "id": "TC018",
    "title": "Conversation History Storage and Retrieval",
    "description": "Verify that each AI chat conversation is stored per user and that conversationMessages and workflow drafts update accordingly.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Send multiple POST /api/chat requests to simulate conversation."
      },
      {
        "type": "assertion",
        "description": "Verify conversation messages accumulate correctly in conversations table."
      },
      {
        "type": "assertion",
        "description": "Verify workflow_draft field updates based on AI generated workflows."
      }
    ]
  },
  {
    "id": "TC019",
    "title": "Enable and Disable Workflows",
    "description": "Verify users can enable or disable workflows and that disabled workflows do not trigger execution.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Update workflow enabled flag to false."
      },
      {
        "type": "assertion",
        "description": "Workflow record updated with enabled false."
      },
      {
        "type": "action",
        "description": "Trigger workflow execution by schedule or webhook."
      },
      {
        "type": "assertion",
        "description": "Verify workflow does not execute when disabled."
      },
      {
        "type": "action",
        "description": "Re-enable workflow."
      },
      {
        "type": "assertion",
        "description": "Workflow executes normally after being enabled."
      }
    ]
  },
  {
    "id": "TC020",
    "title": "Security: Password Hashing Verification",
    "description": "Verify that passwords are hashed using bcrypt and plain passwords are not stored in the database.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Register a new user with known password."
      },
      {
        "type": "assertion",
        "description": "Check database record for password_hash does not equal the plain password."
      },
      {
        "type": "assertion",
        "description": "password_hash matches bcrypt hash format."
      }
    ]
  },
  {
    "id": "TC021",
    "title": "Workflow Execution History Tracking",
    "description": "Verify that each execution of a workflow creates a workflow_executions record with statuses, timestamps, trigger data, step results, and errors if any.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Trigger workflow execution manually or through webhook."
      },
      {
        "type": "assertion",
        "description": "workflow_executions table contains new record with proper workflow_id, status (e.g., started, succeeded, failed), started_at and completed_at timestamps."
      },
      {
        "type": "assertion",
        "description": "trigger_data contains relevant payload."
      },
      {
        "type": "assertion",
        "description": "step_results contain detailed outcomes of each workflow step."
      },
      {
        "type": "assertion",
        "description": "error field contains error details if execution fails."
      }
    ]
  }
]
